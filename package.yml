name       : fpc
version    : 3.0.0
release    : 2
source     :
    - http://pilotfiber.dl.sourceforge.net/project/freepascal/Source/3.0.0/fpc-3.0.0.source.tar.gz : 46354862cefab8011bcfe3bc2942c435f96a8958b245c42e10283ec3e44be2dd
license    : GPL-2.0
component  : programming
summary    : FreePascalCompiler and toolchain
description: |
    FreePascalCompiler and toolchain
builddeps  :
    - fpc
strip      : no
build      : |
    pushd compiler
    fpcmake -Tall
    popd
    %make OS_TARGET=linux CPU_TARGET=x86_64 NOGDB=1
install    : |
    %make_install -j1 PREFIX=$installdir/usr NOGDB=1

    install -d $installdir/etc
    $installdir/usr/lib/fpc/3.0.0/samplecfg $pkgdir/usr/lib/fpc/${pkgver} $installdir/etc
    echo -e "#ifdef cpux86_64\n# for x86_64 use -fPIC by default\n-Cg\n#endif" >> "$installdir/etc/fpc.cfg"
    sed -i "s|lib/$fpcversion|lib/fpc/$fpcversion|" $installdir/etc/fpc.cfg

    ln -s /usr/lib/fpc/3.0.0/ppcx64 $installdir/usr/bin
